<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <title>Application Throughput</title>
    <link rel="stylesheet" type="text/css"
          href="{{SPLUNKWEB_URL_PREFIX}}/static/app/c3-monitor/css/search-bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css"
          href="{{SPLUNKWEB_URL_PREFIX}}/static/app/c3-monitor/splunkjs/css/dashboard.css"/>
    <link rel="stylesheet" type="text/css" href="{{SPLUNKWEB_URL_PREFIX}}/static/build/css/bootstrap-enterprise.css"/>
    <link rel="stylesheet" type="text/css" href="{{SPLUNKWEB_URL_PREFIX}}/static/app/c3-monitor/css/custom.css"/>
</head>
<body>
<!--
BEGIN LAYOUT
This section contains the layout for the dashboard. Splunk uses proprietary
styles in <div> tags, similar to Bootstrap's grid system.
-->
<div class="header splunk-header">
    <div id="placeholder-splunk-bar">
        <a href="{{SPLUNKWEB_URL_PREFIX}}/app/launcher/home" class="brand" title="splunk &gt; listen to your data">splunk<strong>&gt;</strong></a>
    </div>
    <div id="placeholder-app-bar"></div>
</div>
<div id="search-header" class="section-padded section-header">
    <div class="search-bar-wrapper shared-searchbar">
        <form method="get" action="" class="search-form">
            <table class="search-bar search-bar-primary">
                <tbody>
                <tr>
                    <td class="search-input" width="100%">
                        <div id="search" data-cid="view4885" class="shared-searchbar-input"
                             data-view="views/shared/searchbar/Input" data-render-time="0">
                            <div class="search-field-background"></div>
                            <div class="search-field-wrapper">
                                <textarea rows="1" name="search" spellcheck="false" class="search-field"
                                          placeholder="search" id="212426.34197697043" autocorrect="off"
                                          autocapitalize="off" value=""
                                          style="height: 29px; overflow: hidden;"></textarea>
                                <div class="shadowTextarea"
                                     style="position: absolute; left: -9999px; top: -9999px; margin-right: -3000px; padding: 4px 6px; font-size: 12px; line-height: 20px; font-family: 'Droid Sans Mono', Consolas, Monaco, 'Courier New', Courier, monospace; font-weight: 400; word-wrap: break-word; white-space: pre-wrap; border-width: 1px; border-color: rgb(78, 128, 42) rgb(66, 109, 36) rgb(50, 82, 27); border-style: solid; box-sizing: border-box; width: 1233px;">
                                </div>
                            </div>
                        </div>
                        <div class="search-assistant-wrapper" style="margin-left: 4px; display: none;">
                            <a href="#" class="search-assistant-activator icon-triangle-down-small"></a>
                        </div>
                    </td>
                    <td class="search-group">
                        <div class="btn-group dropdown">
                            <input type="hidden" name="throughput-group"/>
                            <a class="btn dropdown-toggle" data-toggle="dropdown" id="dropdownSearchGroup"
                               href="#"><span>by Cluster/Role</span><i class="caret"></i></a>
                            <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownSearchGroup">
                                <li role="presentation"><a role="menuitem" tabindex="-1" data-value="cluster"
                                                           class="dropdown-default" href="#">by Cluster</a></li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" data-value="cluster, role"
                                                           href="#">by Cluster/Role</a></li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" data-value="host" href="#">Individual
                                    Hosts</a></li>
                            </ul>
                        </div>
                    </td>
                    <td class="search-timerange">
                        <div id="search-timerange" class="btn"></div>
                    </td>
                    <td class="search-statistic">
                        <div class="btn-group dropdown">
                            <input type="hidden" name="statistic"/>
                            <a class="btn dropdown-toggle" data-toggle="dropdown" id="dropdownSearchStatistic" href="#"><span>Total &amp; Mean</span>
                                Times<i class="caret"></i></a>
                            <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownSearchStatistic">
                                <li role="presentation"><a role="menuitem" tabindex="-1" data-value="total" href="#">Total</a>
                                </li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" data-value="mean"
                                                           href="#">Mean</a></li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" data-value="total, mean"
                                                           class="dropdown-default" href="#">Total &amp; Mean</a></li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" data-value="median" href="#">Median</a>
                                </li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" data-value="p95" href="#">95th
                                    Percentile</a></li>
                            </ul>
                        </div>
                    </td>
                    <td class="search-layout">
                        <div class="btn-group dropdown">
                            <input type="hidden" name="layout"/>
                            <a class="btn dropdown-toggle" data-toggle="dropdown" id="dropdownSearchLayout"
                               href="#"><span>Small</span> Layout<i class="caret"></i></a>
                            <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownSearchFormat">
                                <li role="presentation"><a role="menuitem" tabindex="-1" data-value="300"
                                                           href="#">Large</a></li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" data-value="220"
                                                           class="dropdown-default" href="#">Small</a></li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" data-value="200"
                                                           href="#">Dense</a></li>
                            </ul>
                        </div>
                    </td>
                    <td class="search-format">
                        <div class="btn-group dropdown">
                            <input type="hidden" name="format"/>
                            <a class="btn dropdown-toggle" data-toggle="dropdown" id="dropdownSearchFormat" href="#">Format
                                <span>Time</span><i class="caret"></i></a>
                            <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownSearchFormat">
                                <li role="presentation"><a role="menuitem" tabindex="-1" data-value="time"
                                                           class="dropdown-default" href="#">Time</a></li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" data-value="time_millis"
                                                           href="#">Time w/ MS</a></li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" data-value="seconds" href="#">Seconds</a>
                                </li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" data-value="seconds_millis"
                                                           href="#">Seconds w/ MS</a></li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" data-value="millis" href="#">Milliseconds</a>
                                </li>
                            </ul>
                        </div>
                    </td>
                    <td class="search-button">
                        <div data-cid="view65350" class="shared-searchbar-submit"
                             data-view="views/shared/searchbar/Submit" data-render-time="0.001">
                            <a class="btn" href="#"><i class="icon-search-thin"></i></a>
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>
        </form>
    </div>
</div>
<div id="hoststats-controls"></div>
<div id="hoststats-table"></div>

<!-- Resource Timings chart -->
<div id="timingchart-title" class="section-header chart-title">
    <h2 class="search-name section-title">
        <i class="icon-clock"></i>
        Resource Timings
    </h2>
</div>
<div id="timingchart-controls" class="splunk-searchcontrols chart-controls">
    <div class="summary shared-jobstatus" style="display: none;">
        <div class="pull-left status shared-jobstatus-count">
            <span class="search-parent"></span>
            <span class="search-progress"></span>
        </div>
        <div class="btn-group pull-right">
            <a class="btn btn-small query" title="show query details" href="#"><i class="icon-search"></i> Query</a>
            <a class="btn btn-small export" title="export chart as SVG" href="#"><i class="icon-report"></i> Export</a>
        </div>
        <div class="btn-group pull-right">
            <a class="btn btn-small chart-type active" title="stacked area chart" data-chart-type="area" href="#"><i
                    class="icon-chart-area"></i> Area</a>
            <a class="btn btn-small chart-type" title="stacked column chart" data-chart-type="column" href="#"><i
                    class="icon-bar-stacked"></i> Column</a>
        </div>
    </div>
</div>
<div id="timingstats-chart"></div>

<!-- Action Rate chart -->
<div id="countchart-title" class="section-header chart-title">
    <h2 class="search-name section-title">
        <i class="icon-gauge-radial"></i>
        Action Rate
    </h2>
</div>
<div id="countchart-controls" class="splunk-searchcontrols chart-controls">
    <div class="summary shared-jobstatus" style="display: none;">
        <div class="pull-left status shared-jobstatus-count">
            <span class="search-parent"></span>
            <span class="search-progress"></span>
        </div>
        <div class="btn-group pull-right">
            <a class="btn btn-small query" title="show query details" href="#"><i class="icon-search"></i> Query</a>
            <a class="btn btn-small export" title="export chart as SVG" href="#"><i class="icon-report"></i> Export</a>
        </div>
        <div class="btn-group pull-right">
            <a class="btn btn-small chart-type active" title="line chart" data-chart-type="line" href="#"><i
                    class="icon-chart-line"></i> Line</a>
            <a class="btn btn-small chart-type" title="column chart" data-chart-type="column" href="#"><i
                    class="icon-bar-beside"></i> Column</a>
        </div>
    </div>
</div>
<div id="countstats-chart"></div>

<!-- Cluster SQL chart -->
<div id="sqlclusterchart-title" class="section-header chart-title">
    <h2 class="search-name section-title">
        <i class="icon-gauge-radial"></i>
        Cluster SQL
    </h2>
</div>
<div id="sqlclusterchart-controls" class="splunk-searchcontrols chart-controls">
    <div class="summary shared-jobstatus" style="display: none;">
        <div class="pull-left status shared-jobstatus-count">
            <span class="search-parent"></span>
            <span class="search-progress"></span>
        </div>
        <div class="btn-group pull-right">
            <a class="btn btn-small query" title="show query details" href="#"><i class="icon-search"></i> Query</a>
            <a class="btn btn-small export" title="export chart as SVG" href="#"><i class="icon-report"></i> Export</a>
        </div>
        <div class="btn-group pull-right">
            <a class="btn btn-small chart-type active" title="stacked area chart" data-chart-type="area" href="#"><i
                    class="icon-chart-area"></i> Area</a>
            <a class="btn btn-small chart-type" title="stacked column chart" data-chart-type="column" href="#"><i
                    class="icon-bar-stacked"></i> Column</a>
        </div>
    </div>
</div>
<div id="sqlclusterstats-chart"></div>

<!-- search assistant dialog -->
<div id="search-assistant" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title"><i class="icon-distributed-environment"></i> Clusters active in last 4h</h4>
            </div>
            <div class="search-assistant-container modal-body">
                <div id="search-assistant-controls"></div>
                <br/>
                <table class="hosts">
                    <thead>
                    <tr>
                        <th class="name">Name</th>
                        <th class="hosts">Hosts</th>
                        <th class="events">Events</th>
                    </tr>
                    </thead>
                </table>
            </div>
            <div class="modal-footer">
                <div class="pull-left">
                    <input type="checkbox" name="roles" style="vertical-align: baseline"/> Show Roles
                </div>
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- query dialog -->
<div id="query-dialog" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title"><i class="icon-search"></i> <span class="which">Current</span> Query</h4>
            </div>
            <div class="modal-body">
                <label for="final">Generated search:</label>
                <textarea name="final" rows="5"></textarea>
                <div class="links">
                    <span>Current Time Range:&nbsp;</span>
                    <div class="btn-group">
                        <a class="btn new-tab current" title="current view in new tab (same settings)" href="#"><i
                                class="icon-plus"></i> Link</a>
                        <a class="btn copy current" title="copy URL to clipboard (same settings)" href="#"><i
                                class="icon-clipboard"></i> Copy</a>
                    </div>
                    <span>&nbsp;&nbsp;Stable Range:&nbsp;</span>
                    <div class="btn-group">
                        <a class="btn new-tab stable" title="current view in new tab (fixed time range)" href="#"><i
                                class="icon-plus"></i> Link</a>
                        <a class="btn copy stable" title="copy URL to clipboard (fixed time range)" href="#"><i
                                class="icon-clipboard"></i> Copy</a>
                    </div>
                </div>
                <label for="splunk">Complete Splunk query:</label>
                <textarea name="splunk" rows="10"></textarea>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<div class="footer"></div>
<!--
END LAYOUT
-->
</body>
<script src="{{SPLUNKWEB_URL_PREFIX}}/config?autoload=1"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/js/i18n.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/i18ncatalog?autoload=1"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/build/simplexml/index.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/c3-monitor/js/bootstrap.min.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/c3-monitor/js/moment.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/c3-monitor/format.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/c3-monitor/export.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/c3-monitor/context.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/c3-monitor/customize.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/c3-monitor/query.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/c3-monitor/charting.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/c3-monitor/searchbar.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/c3-monitor/searchassistant.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/c3-monitor/fields.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/c3-monitor/thrp_fields.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/c3-monitor/thrp_query.js"></script>
<script src="{{SPLUNKWEB_URL_PREFIX}}/static/app/c3-monitor/throughput.js"></script>
<script type="text/javascript">
  require.config({
    baseUrl: "{{SPLUNKWEB_URL_PREFIX}}/static/js",
    waitSeconds: 0 // Disable require.js load timeout
  });

  // LIBRARY REQUIREMENTS
  //
  // In the require function, we include the necessary libraries and modules for
  // the HTML dashboard. Then, we pass variable names for these libraries and
  // modules as function parameters, in order.
  //
  // When you add libraries or modules, remember to retain this mapping order
  // between the library or module and its function parameter. You can do this by
  // adding to the end of these lists, as shown in the commented examples below.
  require([
      "splunkjs/mvc",
      "splunkjs/mvc/utils",
      "splunkjs/mvc/tokenutils",
      "underscore",
      "jquery",
      "splunkjs/mvc/simplexml",
      "splunkjs/mvc/headerview",
      "splunkjs/mvc/footerview",
      "splunkjs/mvc/simplexml/dashboardview",
      "splunkjs/mvc/timerangeview",
      "splunkjs/mvc/searchmanager",
      "splunkjs/mvc/searchcontrolsview",
      "splunkjs/mvc/tableview",
      "splunkjs/mvc/chartview",
      "splunkjs/ready!",
      "moment"
    ],
    function (
      mvc,
      utils,
      TokenUtils,
      _,
      $,
      DashboardController,
      HeaderView,
      FooterView,
      Dashboard,
      TimeRangeView,
      SearchManager,
      SearchControlsView,
      TableView,
      ChartView
    ) {

      var pageLoading = true;


      new SearchManager({
        id: "host-list",
        app: utils.getCurrentApp(),
        autostart: false,
        cache: true,
        preview: true,
        earliest_time: "-4h",
        search: "index=jmx | stats count by host | sort by -count"
      });

      new SearchManager({
        id: "search-hoststats",
        app: utils.getCurrentApp(),
        autostart: false,
        cache: false,
        preview: true,
        earliest_time: "-4h",
        search: mvc.tokenSafe("$hoststats_query$")
      });

      new SearchManager({
        id: "chart-timingstats",
        autostart: false,
        cache: false,
        preview: true,
        earliest_time: mvc.tokenSafe("$earliest$"),
        latest_time: mvc.tokenSafe("$latest$"),
        search: mvc.tokenSafe("$timingstats_chart$")
      });

      new SearchManager({
        id: "chart-countstats",
        autostart: false,
        cache: false,
        preview: true,
        earliest_time: mvc.tokenSafe("$earliest$"),
        latest_time: mvc.tokenSafe("$latest$"),
        search: mvc.tokenSafe("$countstats_chart$")
      });

      new SearchManager({
        id: "chart-sqlclusterstats",
        autostart: false,
        cache: false,
        preview: true,
        earliest_time: mvc.tokenSafe("$earliest$"),
        latest_time: mvc.tokenSafe("$latest$"),
        search: mvc.tokenSafe("$sqlclusterstats_chart$")
      });

      //
      // SPLUNK HEADER AND FOOTER
      //

      new HeaderView({
        id: 'header',
        section: 'dashboards',
        el: $('.header'),
        acceleratedAppNav: true,
        useSessionStorageCache: true,
        splunkbar: true,
        appbar: true,
        litebar: false,
      }, { tokens: true }).render();

      new FooterView({
        id: 'footer',
        el: $('.footer')
      }, { tokens: true }).render();


      //
      // DASHBOARD EDITOR
      //
      new Dashboard({
        id: 'dashboard',
        el: $('.dashboard-body'),
        showTitle: true,
        editable: true
      }, { tokens: true }).render();

      new SearchControlsView({
        id: "hoststats-controls",
        managerid: "search-hoststats",
        el: $("#hoststats-controls")
      }).render();

      new TimeRangeView({
        id: "hoststats-timerange",
        managerid: "search-hoststats",
        preset: "Last 60 minutes",
        earliest_time: mvc.tokenSafe("$earliest$"),
        latest_time: mvc.tokenSafe("$latest$"),
        el: $("#search-timerange")
      }).render();

      new TableView({
        id: "hoststats-table",
        managerid: "search-hoststats",
        pageSize: "4",
        el: $("#hoststats-table"),
        drilldownRedirect: false
      }).render();

      new ChartView({
        id: "timingstats-chart",
        managerid: "chart-timingstats",
        type: "area",
        height: "200px",
        el: $("#timingstats-chart")
      }).render();

      new ChartView({
        id: "countstats-chart",
        managerid: "chart-countstats",
        type: "line",
        height: "200px",
        el: $("#countstats-chart")
      }).render();

      new ChartView({
        id: "sqlclusterstats-chart",
        managerid: "chart-sqlclusterstats",
        type: "area",
        height: "200px",
        el: $("#sqlclusterstats-chart")
      }).render();

      //
      // DASHBOARD READY
      //

      DashboardController.ready();
      pageLoading = false;
    }
  );
</script>
</html>
